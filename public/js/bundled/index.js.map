{"mappings":"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","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/updateSettings.js","public/js/stripe.js","public/js/index.js","public/js/login.js"],"sourcesContent":["export const displayMap = (locations) => {\n  mapboxgl.accessToken =\n    'pk.eyJ1Ijoic2lyYWFtZXIiLCJhIjoiY2w1bjlsZGR1MDk5ZTNpcDgzZHUxdWYwNCJ9.N9_mHqYXW79IGo7zklWbYA';\n\n  var map = new mapboxgl.Map({\n    container: 'map',\n    style: 'mapbox://styles/siraamer/cl0pxdae200hp15qlaqgf37ex',\n    scrollZoom: false,\n    // center: [-118.113491, 34.111745],\n    // zoom: 10,\n    // interactive: false\n  });\n\n  const bounds = new mapboxgl.LngLatBounds();\n\n  locations.forEach((loc) => {\n    // Create marker\n    const el = document.createElement('div');\n    el.className = 'marker';\n\n    // Add marker\n    new mapboxgl.Marker({\n      element: el,\n      anchor: 'bottom',\n    })\n      .setLngLat(loc.coordinates)\n      .addTo(map);\n\n    // Add popup\n    new mapboxgl.Popup({\n      offset: 30,\n    })\n      .setLngLat(loc.coordinates)\n      .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\n      .addTo(map);\n\n    // Extend map bounds to include current location\n    bounds.extend(loc.coordinates);\n  });\n\n  map.fitBounds(bounds, {\n    padding: {\n      top: 200,\n      bottom: 150,\n      left: 100,\n      right: 100,\n    },\n  });\n};\n","export const hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\nexport const showAlert = (type, msg) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, 5000);\n};\n","import axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const updateSettings = async (data, type) => {\n  try {\n    const url =\n      type === 'password'\n        ? '/api/v1/auth/updatepassword'\n        : '/api/v1/auth/updatemyinfo';\n    const res = await axios({\n      method: 'PATCH',\n      url,\n      data,\n    });\n    console.log(data);\n    if (res.data.status === 'success') {\n      showAlert('success', `${type.toUpperCase()} Updated successfully!`);\n    }\n  } catch (err) {\n    console.log(err);\n    showAlert('error', err.response.data.message);\n  }\n};\n","import axios from 'axios';\nimport { showAlert } from './alerts';\nconst stripe = Stripe(\n  'pk_test_51LN39zCRZVXV9ebKTVNEOY9lUYxCfQS0xpp4fEBHxit58QnKe2SRta7RH5RjuPTtwmP2cSt7Vw5G7ttcQlpGqKUb00Aev0SnyH'\n);\n\nconst bookTour = async (tourId) => {\n  //! 1) Get checkout session from API.\n  const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n  console.log(session);\n  //! 2) Create checkout form + charage credit card.\n  try {\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id,\n    });\n  } catch (err) {\n    showAlert('error', err);\n  }\n};\n\nexport { bookTour };\n","import '@babel/polyfill';\nimport { displayMap } from './mapbox';\nimport { login, logout, signup } from './login';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe.js';\n\n// DOM ELEMENTS\nconst mapBox = document.getElementById('map');\nconst signupForm = document.querySelector('.form--signup');\nconst loginForm = document.querySelector('.form--login');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\nconst bookBtn = document.getElementById('book-tour');\n// DELEGATION\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (signupForm) {\n  signupForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const name = document.getElementById('name').value;\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('passwordConfirm').value;\n\n    signup(name, email, password, passwordConfirm);\n  });\n}\n\nif (loginForm)\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    login(email, password);\n  });\n\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\n\nif (userDataForm)\n  userDataForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value);\n    form.append('email', document.getElementById('email').value);\n    form.append('photo', document.getElementById('photo').files[0]);\n\n    updateSettings(form, 'data');\n  });\n\nif (userPasswordForm)\n  userPasswordForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n    const passwordCurrent = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await updateSettings(\n      { passwordCurrent, password, passwordConfirm },\n      'password'\n    );\n\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n\nif (bookBtn)\n  bookBtn.addEventListener('click', (e) => {\n    e.target.textContent = 'Processing...';\n    const { tourId } = e.target.dataset;\n    bookTour(tourId);\n  });\n","/* eslint-disable */\nimport axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const login = async (email, password) => {\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: 'http://localhost:7000/api/v1/auth/login',\n      data: {\n        email,\n        password,\n      },\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', 'Logged in successfully!');\n      window.setTimeout(() => {\n        location.assign('/');\n      }, 1500);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: 'GET',\n      url: '/api/v1/auth/logout',\n    });\n    if ((res.data.status = 'success')) location.assign('/login');\n  } catch (err) {\n    console.log(err.response);\n    showAlert('error', 'Error logging out! Try again.');\n  }\n};\n\nexport const signup = async (name, email, password, passwordConfirm) => {\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: '/api/v1/auth/signup',\n      data: {\n        name,\n        email,\n        password,\n        passwordConfirm,\n      },\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', 'Signed up successfully');\n      window.setImmediate(() => {\n        location.assign('/');\n      }, 1500);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n"],"names":["$4d572beac43e4a89$export$5a81baf3e1f8b5bb","el","document","querySelector","parentElement","removeChild","$4d572beac43e4a89$export$e2ed28791945543d","type","msg","markup","insertAdjacentHTML","window","setTimeout","$4326a1d138ee161f$export$81acc09c7bdb4525","async","data","url","res","$parcel$interopDefault","$2zzzt$axios","method","console","log","status","toUpperCase","err","response","message","$54895d6a17d38c40$var$stripe","Stripe","$9b805de406e0a0f0$var$mapBox","getElementById","$9b805de406e0a0f0$var$signupForm","$9b805de406e0a0f0$var$loginForm","$9b805de406e0a0f0$var$logOutBtn","$9b805de406e0a0f0$var$userDataForm","$9b805de406e0a0f0$var$userPasswordForm","$9b805de406e0a0f0$var$bookBtn","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LngLatBounds","forEach","loc","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","$fa204ea79c7a1b9c$export$976c4dce80bbf3f7","JSON","parse","dataset","addEventListener","e","preventDefault","name","email","password","passwordConfirm","setImmediate","location","assign","$b06adc82efdacc57$export$2f97a53cb9467bd1","value","$b06adc82efdacc57$export$4a142f624dd0fa8","form","FormData","append","files","textContent","passwordCurrent","target","tourId","session","redirectToCheckout","sessionId","id","$54895d6a17d38c40$export$54ca10ceadf03905"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}